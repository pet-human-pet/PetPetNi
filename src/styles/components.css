@layer components {
  /* Foundations (everyone can use) */

  /* =========================
   * 文字元件基底
   * ========================= */

  .c-title {
    @apply text-xl;
  }

  .c-subtitle {
    @apply text-lg;
  }
  .c-meta {
    @apply text-xs;
  }

  /* =========================
   * 按鈕元件基底
   * ========================= */
  .c-btn {
    @apply rounded-btn inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium transition-colors disabled:cursor-not-allowed disabled:opacity-50;
  }

  /* =========================
   * 主要按鈕（黃底深咖字）
   * 用途：主要 CTA（Submit, Confirm）
   * ========================= */
  .c-btn--primary {
    @apply rounded-btn bg-btn-primary text-fg-primary inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium transition-colors hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-50;
  }

  /* =========================
   * 次要按鈕（灰底灰咖字）
   * 用途：次要操作（Cancel, Back）
   * ========================= */
  .c-btn--secondary {
    @apply rounded-btn text-fg-secondary inline-flex items-center justify-center gap-2 bg-gray-100 px-4 py-2 text-sm font-medium transition-colors hover:bg-gray-200 disabled:cursor-not-allowed disabled:opacity-50;
  }

  /* =========================
   * 黃色按鈕（黃底咖字）
   * 用途：次要 CTA、強調操作
   * ========================= */
  .c-btn--accent {
    @apply rounded-btn bg-brand-primary text-fg-primary hover:bg-brand-primary/90 inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium transition-colors disabled:cursor-not-allowed disabled:opacity-50;
  }

  /* =========================
   * 特定元件樣式（僅限內部使用）
    * ========================= */

  /* Home */

  /* MenuOverlay鎖定 */
  @layer utilities {
    .u-lock-scroll {
      overflow: hidden;
      overscroll-behavior: none;
    }
    .u-no-tap-highlight,
    .u-no-tap-highlight * {
      -webkit-tap-highlight-color: transparent;
      tap-highlight-color: transparent;
    }
  }

  /* Header / Nav Icon Button */
  .c-icon-btn {
    @apply relative inline-flex items-center justify-center rounded-full transition-colors;
    @apply h-10 w-10 max-md:h-9 max-md:w-9;
    @apply text-fg-secondary hover:bg-bg-base hover:text-brand-primary;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
  }

  /* Header Function Button (Message, Notification, Favorite) */
  .c-header-btn {
    @apply text-fg-secondary relative flex h-10 w-10 cursor-pointer items-center justify-center rounded-full transition;
    @apply hover:bg-bg-base hover:text-brand-primary;
  }

  /* Header dropdown / popover 容器（桌機） */
  .c-popover {
    @apply bg-bg-surface shadow-card rounded-card border-border-default overflow-hidden border;
  }

  /* Header sheet / dialog 容器（手機） */
  .c-sheet {
    @apply bg-bg-surface shadow-dialog rounded-card border-border-default overflow-hidden border;
  }

  /* 收藏清單 item */
  .c-list-item {
    @apply rounded-card hover:bg-bg-base p-3 transition-colors;
  }

  /* Social */

  /* ActionBar */
  .action-icon {
    transition: transform 150ms ease;
    transform-origin: center;
  }

  .action-btn:hover .action-icon {
    transform: scale(1.1);
  }

  /* 卡片元件基底 */
  .c-card {
    @apply bg-bg-surface shadow-card rounded-card p-4;
  }

  /* 開啟留言動畫 */
  .animate-pop-in {
    animation: popIn 0.2s cubic-bezier(0.16, 1, 0.3, 1);
  }
  @keyframes popIn {
    from {
      opacity: 0;
      transform: scale(0.95) translateY(10px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }

  /* 底部滑入動畫 */
  .animate-slide-up {
    animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }
  @keyframes slideUp {
    from {
      transform: translateY(100%);
    }
    to {
      transform: translateY(0);
    }
  }

  /* 右側滑入動畫 */
  .animate-slide-right {
    animation: slideRight 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }
  @keyframes slideRight {
    from {
      transform: translateX(-100%);
    }
    to {
      transform: translateX(0);
    }
  }

  /* 自定義Scrollbar */
  .scrollbar {
    scrollbar-width: thin;
    scrollbar-color: lightgray white;
  }

  /* Chat */

  /* 聊天室專用顏色變數 */
  @theme {
    --color-status-match: #f97316;
    --color-status-knock: #9333ea;
    --color-status-error: #ef4444;
    --color-bg-brand-light: #f9fbf2;
    --color-status-friend: #ff9a8b;
    --color-fg-terracotta: #cf7451;
  }

  .c-badge {
    @apply bg-brand-accent absolute flex items-center justify-center rounded-full leading-none font-bold text-white;
  }
  .c-badge--dot {
    @apply h-2 w-2 border border-white;
  }
  .c-badge--num {
    @apply h-3.5 min-w-3.5 px-1 text-[8px];
  }

  .c-chat-bubble {
    @apply relative flex cursor-pointer flex-col gap-1 rounded-2xl px-4 py-3 text-sm leading-relaxed break-all shadow-sm transition-opacity hover:opacity-95;
  }
  .c-chat-bubble--me {
    @apply bg-brand-primary rounded-br-sm text-white;
  }
  .c-chat-bubble--them {
    @apply border-border-default bg-bg-surface text-fg-primary rounded-bl-sm border;
  }

  .c-chat-item {
    @apply hover:bg-bg-base relative mb-1 flex cursor-pointer items-center rounded-xl px-4 py-3 transition-colors;
  }

  .c-chat-info {
    @apply ml-3 min-w-0 flex-1;
  }

  .c-chat-title {
    @apply mb-1 flex items-center justify-between;
  }

  .c-chat-name {
    @apply text-fg-primary flex items-center gap-1 text-base font-bold;
  }

  .c-chat-desc {
    @apply text-fg-secondary h-5 truncate text-sm;
  }

  .c-chat-avatar {
    @apply h-12 w-12 rounded-xl border border-black/5 bg-gray-200 bg-cover bg-center shadow-sm transition-transform hover:scale-105;
  }

  .c-chat-label {
    @apply rounded px-1 text-[10px] font-bold;
  }

  .c-chat-nav {
    @apply text-fg-muted hover:text-brand-primary relative flex h-full w-13 shrink-0 cursor-pointer flex-col items-center justify-center transition-all duration-200 hover:bg-black/5 md:h-12 md:w-full md:flex-row md:items-center md:justify-start md:gap-3 md:rounded-lg md:px-3;
  }

  .c-chat-nav-active {
    @apply bg-brand-primary shadow-brand-primary/30 text-white shadow-lg;
    @apply hover:bg-brand-primary/90 hover:text-white;
  }

  .c-chat-section-label {
    @apply rounded-md px-2 py-0.5 text-xs font-black tracking-wider;
  }
  .c-chat-section-label--accent {
    @apply bg-brand-accent/10 text-brand-accent;
  }
  .c-chat-section-label--primary {
    @apply bg-brand-primary/10 text-brand-primary;
  }
  .c-chat-section-label--muted {
    @apply bg-fg-muted/10 text-fg-muted;
  }

  .c-chat-tab {
    @apply flex-1 cursor-pointer rounded-full border py-1.5 text-sm font-bold whitespace-nowrap transition-all duration-200;
    @apply border-border-default text-fg-muted hover:bg-bg-base bg-transparent;
  }

  .c-chat-tab-active {
    @apply bg-brand-primary hover:bg-brand-primary/90 border-transparent text-white shadow-sm hover:text-white;
  }

  .c-chat-menu {
    @apply hover:bg-bg-base flex w-full cursor-pointer items-center gap-3 px-4 py-2.5 text-left text-sm font-bold transition-colors;
  }
  .c-chat-menu i {
    @apply w-5 text-center;
  }

  .c-chat-menu-danger {
    @apply text-red-500 hover:bg-red-50;
  }
  .c-chat-pop {
    @apply absolute z-50 flex items-center gap-1 rounded-lg border border-[#dce4d1] bg-[#ecf0e5] p-1 text-xs whitespace-nowrap text-[#2d3a12] shadow-lg;
  }

  .c-chat-opt {
    @apply flex cursor-pointer items-center gap-1 rounded px-3 py-2 font-bold transition-opacity hover:opacity-70;
  }

  .c-chat-opt i {
    @apply text-[#556b2f];
  }

  .c-chat-arrow {
    @apply absolute h-0 w-0 border-x-[6px] border-x-transparent;
  }

  .c-icon-edit {
    @apply text-fg-muted hover:text-brand-primary cursor-pointer opacity-100 transition-all md:opacity-0 md:group-hover:opacity-100;
  }

  .c-ai-prompt-btn {
    @apply border-border-default hover:bg-bg-base hover:border-brand-primary/50 text-fg-primary flex items-center gap-2 rounded-xl border bg-white p-2.5 text-left text-sm transition-all;
  }

  .c-ai-prompt-btn__icon {
    @apply bg-brand-primary/10 text-brand-primary flex h-6 w-6 shrink-0 items-center justify-center rounded-full;
  }

  .c-chat-input-container {
    @apply border-border-default bg-bg-surface flex shrink-0 flex-col border-t p-4 pb-7.5 md:pb-4;
  }

  .c-chat-reply-bar {
    @apply border-brand-primary mb-2 flex items-center justify-between border-l-4 bg-zinc-50 px-3 py-2;
  }

  .c-chat-input-field {
    @apply bg-bg-base focus-within:border-brand-primary relative flex flex-1 flex-col overflow-hidden rounded-2xl border border-transparent transition-colors;
  }

  /* 個人資料標籤 (好友/我) */
  .c-profile-tag {
    @apply pointer-events-auto ml-24 rounded-md px-2 py-0.5 text-[10px] font-bold tracking-widest whitespace-nowrap uppercase;
  }

  .c-profile-tag--friend {
    @apply bg-status-friend/20 text-status-friend;
  }

  .c-profile-tag--me {
    @apply bg-brand-primary/20 text-brand-primary;
  }

  /* Profile */

  /* Event 側邊欄卡片項目 */
  .c-event-card {
    @apply border-border-default bg-bg-surface shadow-card hover:shadow-card relative flex h-40 w-60 flex-none cursor-pointer snap-center flex-col justify-between overflow-hidden rounded-2xl border transition hover:-translate-y-0.5 md:h-auto md:w-full md:rounded-xl;
  }

  .c-event-card--active {
    @apply border-brand-primary bg-bg-base border-2;
  }

  /* Event */

  /* =========================
   * 無滾動條樣式（用於需要隱藏滾動條的區域）
   * ========================= */
  @layer utilities {
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
  }

  /* 輸入框與下拉選單 */
  .c-input,
  .c-select {
    @apply border-border-default bg-bg-surface text-fg-primary placeholder:text-fg-muted focus:border-brand-primary disabled:text-fg-muted h-11 w-full rounded-lg border px-3 py-2 text-sm transition-colors outline-none disabled:bg-gray-100;
  }
  /* 狀態區塊（背景色 + 邊框色） */
  .c-status-block--success {
    background-color: #f6fffb;
    border-color: #d1fae5;
  }

  .c-status-block--warning {
    background-color: #fffcf7;
  }

  /* UI (modal/dropdown/toast) */
  .c-dialog-overlay {
    @apply fixed inset-0 z-100 flex items-center justify-center bg-black/50 px-4;
  }

  .c-dialog-box {
    @apply bg-bg-surface w-full max-w-sm overflow-hidden rounded-2xl shadow-2xl transition-all;
  }

  /* 檢舉對話框專用 */
  .c-report-reason {
    @apply hover:bg-bg-base flex cursor-pointer items-center gap-3 rounded-lg border p-3 transition-colors;
  }

  .c-report-reason--active {
    @apply border-brand-primary bg-brand-primary/5;
  }

  .c-report-input {
    @apply border-border-default bg-bg-base focus:border-brand-primary mt-2 w-full rounded-lg border p-3 text-sm outline-none;
  }

  /* Transition: Fade */
  .fade-enter-active,
  .fade-leave-active {
    transition: opacity 0.2s ease;
    will-change: opacity;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  .fade-enter-from,
  .fade-leave-to {
    opacity: 0;
  }

  .fade-slide-enter-active,
  .fade-slide-leave-active {
    transition:
      opacity 0.3s ease,
      transform 0.3s ease;
    will-change: opacity, transform;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  .fade-slide-enter-from,
  .fade-slide-leave-to {
    opacity: 0;
    transform: translateY(-10px);
  }

  /* 防止 Transition 內子元素閃爍 */
  .fade-enter-active *,
  .fade-leave-active *,
  .fade-slide-enter-active *,
  .fade-slide-leave-active * {
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform: translateZ(0);
  }

  .c-toast {
    @apply pointer-events-auto relative flex w-[320px] items-center gap-3 overflow-hidden rounded-xl border px-5 py-3.5 shadow-md;
    background-color: #ffffff;
    isolation: isolate;
  }

  .c-toast::before {
    content: '';
    @apply absolute inset-0 -z-10 opacity-100;
  }

  .c-toast--success {
    @apply border-brand-primary/20;
  }
  .c-toast--success::before {
    background-color: #f0f6f4;
  }
  .c-toast--success i {
    @apply text-brand-primary;
  }

  .c-toast--error {
    @apply border-func-danger/20;
  }
  .c-toast--error::before {
    background-color: #fff4f4;
  }
  .c-toast--error i {
    @apply text-func-danger;
  }

  .c-toast--info {
    @apply border-brand-accent/20;
  }
  .c-toast--info::before {
    background-color: #fefae9;
  }
  .c-toast--info i {
    @apply text-brand-accent;
  }

  /* Toast Progress Animation */
  @keyframes toast-progress {
    from {
      width: 100%;
    }
    to {
      width: 0%;
    }
  }
  .c-toast-progress {
    @apply absolute bottom-0 left-0 h-0.5 bg-black/5;
    animation: toast-progress linear forwards;
  }
  .notification-list {
    background-color: #fffcf7;
    @apply ring-[#ffe2c4];
    @apply hover:bg-[#fff3e6];
  }

  .c-btn-back {
    @apply text-fg-muted hover:text-brand-primary z-10 cursor-pointer transition-transform duration-200 ease-out will-change-transform hover:-translate-x-1 
  }
}